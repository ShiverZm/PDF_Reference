# 5.1.3 字形定位和度量

**一个字形的宽度(Glyph Width)**——形式上，它的水平位移——是它沿水平书写的一行文本的基线所占据的空间量。换句话说，它是指绘制符号时当前文本位置(通过翻译文本空间)移动的距离。请注意，宽度与字形轮廓的尺寸不同。

在某些字体中，宽度是恒定的;它不会因不同的字形而变化。这种字体被称为固定间距或等宽字体。它们主要用于打字机式打印。然而，用于高质量排版的大多数字体都与每个字形关联不同的宽度。这种字体被称为比例字体或可变音高字体。在这两种情况下，Tj操作符根据字符串的连续符号的宽度来定位它们。

每个字形的宽度信息存储在字体字典和字体程序本身中。(两套宽度必须相同;将此信息存储在字体字典中(尽管是多余的)，使消费者应用程序无需查看字体程序内部就可以确定字形的位置。)用于显示文本的操作符的设计基于这样一个假设:符号通常是根据其标准宽度来定位的。然而，提供了以某些有限的方式改变定位的手段。例如，TJ操作符允许在文本字符串中对应的任意连续的符号对之间调整文本位置。有图形状态参数来系统地调整字符和字间距。

除了宽度之外，字形还有几个其他指标可以影响字形的定位和绘制。对于大多数字体类型，这些信息主要是字体程序内部的，并没有在PDF字体字典中明确指定。然而，在Type 3字体中，所有指标都明确指定(见章节5.5.4“Type 3字体”)。

**符号坐标系统(Glyph Metrics)是定义单个字符符号的空间**。所有路径坐标和度量都在符号空间中解释。对于除Type 3以外的所有字体类型，符号空间的单位是文本空间单位的千分之一;对于Type 3字体，从字形空间到文本空间的转换由字体中明确的FontMatrix条目中指定的字体矩阵来定义。图5.4显示了一个典型的字形轮廓及其度量。

![](<../../.gitbook/assets/image (9).png>)

**字形原点（Glyph Origin）是符号坐标系统中的点(0,0)**。Tj和其他文本显示操作符将要绘制的第一个字形的原点定位在文本空间的原点。例如，下面的代码将用户坐标系统中的文本空间的原点调整为(40,50)，然后将A字形的原点放在该点，

```
BT
40 50 Td
(ABC) Tj
ET
```

**字形位移**是指在绘制一行文本的连续符号时，从字形的原点到通常应该放置下一个字形的原点的距离。这个距离是字形坐标系中的一个向量（称为位移向量）；它具有水平和垂直分量。（水平的位移通常称为宽度。）大多数西方书写系统，包括那些基于拉丁字母的系统，有正水平位移和零垂直位移。一些亚洲的写作系统的垂直位移为非零。在所有情况下，文本显示操作符都将位移向量转换为文本空间，然后按该量转换文本空间。

**字形边界框(Glyph Bounding Box)是最小的矩形（以字形坐标系的轴方向）**，只是包含整个字形形状。边界框用其相对于字形坐标系中的字形原点的左、下、右和上坐标表示。

在一些书写系统中，文本经常在两个不同的方向上对齐。例如，水平和垂直书写日语和中文符号是很常见的。为了处理这个问题，一个字体可以选择包含每个符号的第二组度量值。根据书写模式选择要使用的度量集，其中0指定水平书写，1指定垂直书写。此功能仅适用于复合字体，请在第5.6节“复合字体”中讨论。

当一个符号有两组度量时，每一组都为该写入模式指定一个符号原点和一个位移向量。在垂直书写中，符号位置是从水平书写的原点（原点0）到垂直书写的原点（原点1）。图5.5说明了这两种书写模式的指标：

* 左图显示了与书写模式0相关的符号度量，水平书写。坐标ll和ur指定了字形相对于原点0的边界框。W0是位移矢量，指定在书写模式0中绘制符号后文本位置如何改变;其垂直组件始终为0。
* 中心图显示了写作模式1，垂直写作。W1是写入模式1的位移向量，它的水平分量始终为0。
* 在右图中，v是定义原点1相对于原点0的位置的位置向量。



![](<../../.gitbook/assets/image (10).png>)

字形度量信息也可以以Adobe字体度量(AFM)和Adobe复合字体度量(ACFM)文件的形式单独提供。这些文件用于生成PDF页面描述的应用程序使用，并且必须根据图形的宽度和其他度量做出格式化决策。在AFM和ACFM文件中还可提供角整理信息，它允许生成PDF文件的应用程序根据上下文确定字形之间的间距调整。AFM和ACFM文件格式的规范可在Adobe技术说明#5004、Adobe字体度量文件格式规范中获得；这些文件可从Adobe解决方案网络网站获取（请参见参考书目）。

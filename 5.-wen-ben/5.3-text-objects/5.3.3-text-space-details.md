# 5.3.3 文本空间详情(Text Space Details)

如第5.3.1节“文本定位操作符”所述，文本显示在文本空间中，文本空间由文本矩阵、Tm和文本状态参数Tfs、Th和Trise的组合来定义。这决定了文本坐标如何转换为用户空间。字形的形状和位移（水平或垂直）都在文本空间中进行解释。

注：字形实际上是在字形空间中定义的，其定义根据5.1.3节“字形定位和指标”中讨论的字体类型而不同。字形坐标首先从字形空间转换为文本空间，然后进行下面描述的转换。

从文本空间到设备空间的整个转换可以用文本渲染矩阵Trm来表示：

![](<../../.gitbook/assets/image (38).png>)

Trm是一个临时矩阵；从概念上讲，它会在文本显示操作中绘制每个字形之前重新计算。

绘制图形后，将根据图形位移和应用的任何间距参数更新文本矩阵。首先，计算组合位移，用水平书写模式的tx或垂直书写模式的ty表示（与另一种书写模式对应的变量设置为0)：

![](<../../.gitbook/assets/image (43).png>)

w0和w1是字形的水平和垂直位移

Tj是由Tj数组中的一个数字指定的位置调整，如果有的话

Tfs和Th是图形状态下的当前文本字体大小和水平缩放参数

Tc和Tw是图形状态下的当前字符和字间距参数

然后将文本矩阵更新如下：

![](<../../.gitbook/assets/image (32).png>)

